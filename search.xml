<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Mysql 优化 (二)]]></title>
    <url>%2F2019%2F04%2F22%2F2019-04-22-Mysql%20%E4%BC%98%E5%8C%96%20(%E4%BA%8C)%2F</url>
    <content type="text"><![CDATA[优化的方面 索引相关 分表设计 架构设计 慢查询日志收集 其他优化 Index 它是物理存在的 规则 字段独立原则 name (对)name + 2 (错)左原则like ‘bill%’ (对)like ‘%bill’ (错)复合索引不能直接使用第2个字段or 原则左右都有索引，会合并索引一起使用一边有索引、一边没有索引，导致整体都没得索引使用 设计依据 被频繁使用的字段设置索引 * 字段被频繁用在where和order等条件里边。 * 数据表创建完毕，要预估那些字段被经常使用，就给其创建索引 执行时间长的sql语句考虑设计索引 * 可以利用”慢查询日志”收集这样的sql语句并优化设计索引 逻辑非常重要的sql语句考虑设计索引 * 例如商城系统里边，会员给自己账户充值就比较重要 * 还有会员下订单购物，进行付款的时候也比较重要。 字段内容足够花样化，适合创建索引 * 反面教材，性别不能设计索引(内容的取值非常少) 前缀索引 什么是前缀索引： 如果一个字段内容的前边的n位信息已经足够标识当前的字段内容，就可以把字段的前n位获得出来并创建索引，通过字段内容前n位创建的索引就称为“前缀索引”。 语法：alter table 表名 add key (字段(前n 位 位数)); 123测试，取前几位，可以获取索引select count(distinct(substring())) from emp;alter table emp add key(password(3)); substring(字段,开始位置,长度n) 截取字段内容，字段下标从1开始 全文索引 把字段中的一些关键字单词出来制作索引 123456789101112131415CREATE TABLE articles ( id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY, title VARCHAR(200), body TEXT)engine=myisam charset utf8;INSERT INTO articles (title,body) VALUES (&apos;MySQL Tutorial&apos;,&apos;DBMS stands for DataBase ...&apos;), (&apos;How To Use MySQL Well&apos;,&apos;After you went through a ...&apos;), (&apos;Optimizing MySQL&apos;,&apos;In this tutorial we will show ...&apos;), (&apos;1001 MySQL Tricks&apos;,&apos;1. Never run mysqld as root. 2. ...&apos;), (&apos;MySQL vs. YourSQL&apos;,&apos;In the following database comparison ...&apos;), (&apos;MySQL Security&apos;,&apos;When configured properly, MySQL ...&apos;);alter table articles add fulltext key (body); 全文索引会解决like模糊查找不用索引的问题： select * from 表名 like ‘%内容%’; //不会使用索引 以上模糊查找如果必须使用索引，就可以使用全文索引 select * from 表名 where 字段 like ‘%内容%’; //不会用到全文索引 select * from 表名 where match(字段) against(内容) //会用到全文索引 全文索引注意 字段类型必须为varchar/char/text类型 mysql 5.6.4之前只有Myisam支持，5.6.4之后则Myisam和innodb都支持。 mysql中的全文索引目前只支持英文(不支持中文)，如果需要支持中文可以使用sphinx 生产活动中mysql的全文索引不常使用，sphinx常使用 mysql全文索引会自作聪明，对关键字的收录有自己的考虑(不是全部关键字都给收录)。 例如生活常用单词、频繁使用单词都不给创建索引(比如 for when where run you等等) 索引结构 索引就是数据结构， 数据以一定的结构组织起来，内部嵌入算法，算法可以保证数据被快速获取。 数据结构：数据以一种规律的、规则的方式组织在一起。(例如0-9顺序排列数字、a-z顺序排列字母等) 主要讨论两种：Myisam 和 Innodb..Mysql的索引数据结构都是B+tree结构(除此还有B-tree、二叉树等结构) 分表设计 一个数据表里边存储的记录信息太多了，例如记录的条数达到1-2亿条信息，该数据表的活性就大大降低，运行速度、效率大打折扣，影响mysql数据库的整体性能，因此要给数据表进行分表设计，使得每个表存储少量的数据。 逻辑分表 注意：分表字段必须是主键 或 主键的一部分(复合主键索引的第二个字段也可以) range 分表 [范围方式] 语法：partition by range(表达式 | 字段)( partition 名称1 values less than (常量整数值), partition 名称2 values less than (常量整数值), … …) range 添加分表 语法：alter table 表名 add partition( partition 名称1 values less than (常量整数值), … …) list 分表 [范围方式] 语法：partition by list(month(pubdate))( partition 名称 values in (列表范围), … …) list 添加分表 语法：alter table 表名 add partition( partition 名称 values in (列表范围), … …) range, list 删除分表 语法：alter table 表名 drop partition 分区名称 key 分表 [求余方式] 语法：partition by key(条件字段) partitions 数量; hash 分表 [求余方式] partition by hash (表达式|字段) partitions 数量 key, hash 添加分表 alter table 表名 add partition partitions 数量; key, hash 删除分表 alter table 表名 coalesce partition 数量 物理分表垂直分表]]></content>
      <categories>
        <category>mysql</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mysql 优化 (一)]]></title>
    <url>%2F2019%2F04%2F22%2F2019-04-22-Mysql%20%E4%BC%98%E5%8C%96%20(%E4%B8%80)%2F</url>
    <content type="text"><![CDATA[优化的方面 存储层：数据表”存储引擎”选取、字段类型选取、逆范式(3范式) 设计层：索引、分区/分表 架构层：分布式部署(集群) sql语句层：结果一样的情况下，要选择效率高、速度快、节省资源的sql语句执行 存储引擎 查看引擎：show engines; MYISAM .frm : 表结构文件 .MYD : 数据文件(mysql data) .MYI : 索引文件(mysql index) (支持物理复制、粘贴以实现数据的备份、还原操作) 数据写入顺序 数据写入时候，不会按照主键id值给予排序存储，该特点导致数据写入的速度非常快。写没有固定顺序，存也按照写的顺序存，不给考虑先后顺序。 并发性 mysiam的并发性(同时处理工作的能力)较比innodb要稍逊色因为数据表是“表锁”(innodb行锁) 压缩 如果一个myisam数据表存储的数据非常多，就会占据很大的硬盘空间，硬盘空间我们不在乎，在乎的是mysql数据库系统为了处理该数据表就需要分配更多的资源，为了节省资源，可以把这个myisam数据表给进行压缩处理。 123[root@localhost ~] pwd/usr/bin/myisampack压缩语法：myisampack 表名(绝对路径定义) 压缩后的数据表仍然可以支持查询操作,压缩后的数据表需要根据最新的数据位置把索引重新建立一次。根据压缩后的据把索引重建建立起来。 123[root@localhost ~] find / -name myisamchk/usr/bin/myisamchk重建索引语法：myisamchk -rq 表名(绝对路径定义) 压缩的数据表不能再写入数据了(尝试写入会造成数据表崩溃)，必须解压后才可以。(解压缩的同时，索引会自动重建) 1解压语法：myisamchk --unpack 表名(绝对路径定义) innodb .frm : 结构文件 .ibd : 数据/索引文件 innodb数据表不能直接的复制/粘贴文件，以便做进行备份还原，可以通过如下指令完成数据的备份和还原： 12mysqldump -uroot -p密码 数据库名字 &gt; /home/xiaogang/xxx.sql [备份]mysql -uroot -p密码 数据库名字 &lt; /home/xiaogang/xxx.sql [还原] 数据写入顺序 该innodb数据表，数据的写入顺序 与 存储的顺序不一致，需要按照主键的顺序把记录摆放到对应的位置上去，速度比Myisam的要稍慢。 并发性 并发性高，多人同时请求，速度快、效率高。innodb锁机制：行锁，每次只锁住一条记录信息。 myisam , innodb 的取舍 myisam： 写入数据非常快，适合使用场合dedecms/phpcms/discuz/微博系统等写入、读取操作多的系统。 innodb: 适合业务逻辑比较强的系统，修改 操作较多的，例如ecshop、crm、办公系统、商城系统 memory内存存储引擎， 特点：内部数据都运行在内存中，数据存储也在内存中，速度非常快，临时存储一些信息 缺点：服务器如果断电，就会清空该存储引擎的全部数据 设置索引1234alter table student5 add primary key (id);alter table student5 add unique key (name);alter table student5 add key (height);alter table student5 add fulltext key (introduce); 删除索引 语法：alter table 表名 drop key 索引名称; //[非主键]索引删除(唯一/普通/全文/复合)alter table 表名 drop primary key; //[主键]索引删除 注意：删除主键索引，必须先去除auto_increment属性 可以修改配置，改变innodb数据表的数据、索引文件的存储方式： * set global innodb_file_per_table=1/0; InnodB数据表数据、索引合并文件分为两种情况： * 每个数据表都有自己的数据、索引合并文件 * 数据库中全部的数据表共享一个数据、索引合并文件]]></content>
      <categories>
        <category>mysql</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[二叉查找树]]></title>
    <url>%2F2019%2F03%2F23%2F2019-03-23-%E4%BA%8C%E5%8F%89%E6%9F%A5%E6%89%BE%E6%A0%91%2F</url>
    <content type="text"><![CDATA[Go 语言实现 二叉查找树。 日常笔记。原文 定义二叉查找树（Binary Search Tree），也称有序二叉树（ordered binary tree）,排序二叉树（sorted binary tree），是指一棵空树或者具有下列性质的二叉树： 若任意节点的左子树不空，则左子树上所有结点的值均小于它的根结点的值；若任意节点的右子树不空，则右子树上所有结点的值均大于它的根结点的值；任意节点的左、右子树也分别为二叉查找树。没有键值相等的节点（no duplicate nodes）。 实现结构体1234567891011// 二叉查找树type Tree struct &#123; Root *Node&#125;// 结点type Node struct &#123; Value int Left *Node Right *Node Parent *Node&#125; 添加一个结点123456789101112131415161718192021222324252627func (this *Tree) Insert(v int) &#123; n := new(Node) n.Value = v if this.Root == nil &#123; this.Root = n return &#125; cur := this.Root for &#123; n.Parent = cur if v &lt; cur.Value &#123; if cur.Left == nil &#123; cur.Left = n break &#125; else &#123; cur = cur.Left &#125; &#125; else &#123; if cur.Right == nil &#123; cur.Right = n break &#125; else &#123; cur = cur.Right &#125; &#125; &#125;&#125; 遍历树1234567891011func (this *Tree) Select() &#123; var mapSearch func(n *Node) mapSearch = func(n *Node)&#123; if n != nil &#123; mapSearch(n.Left) fmt.Println(n.Value) mapSearch(n.Right) &#125; &#125; mapSearch(this.Root)&#125; 查找一个结点123456789101112131415161718func (this *Tree) Search(v int) *Node&#123; cur := this.Root for &#123; if v &lt; cur.Value &#123; cur = cur.Left if cur == nil &#123; return nil &#125; &#125; else if v &gt; cur.Value &#123; cur = cur.Right if cur == nil &#123; return nil &#125; &#125; else &#123; return cur &#125; &#125;&#125; 最小结点12345678910func (this *Tree) Min() *Node&#123; cur := this.Root for &#123; if cur.Left != nil &#123; cur = cur.Left &#125; else &#123; return cur &#125; &#125;&#125; 最大结点12345678910func (this *Tree) Max() *Node&#123; cur := this.Root for &#123; if cur.Right != nil &#123; cur = cur.Right &#125; else &#123; return cur &#125; &#125;&#125; 删除一个结点12345678910111213141516171819202122232425262728293031323334353637383940414243444546func (this *Tree) Delete(v int) &#123; fmt.Printf(&quot;del: %d\n&quot;,v) var ( mapDel func (n *Node) cur = this.Search(v) ) mapDel = func (cur *Node) &#123; if cur == nil &#123; return &#125; if cur.Left == nil &amp;&amp; cur.Right == nil &#123; if cur.Parent.Left == cur &#123; cur.Parent.Left = nil &#125; else &#123; cur.Parent.Right = nil &#125; &#125; else if cur.Left == nil &amp;&amp; cur.Right != nil &#123; cur.Right.Parent = cur.Parent if cur.Parent.Left == cur &#123; cur.Parent.Left = cur.Right &#125; else &#123; cur.Parent.Right = cur.Right &#125; &#125; else if cur.Left != nil &amp;&amp; cur.Right == nil &#123; cur.Left.Parent = cur.Parent if cur.Parent.Left == cur &#123; cur.Parent.Left = cur.Left &#125; else &#123; cur.Parent.Right = cur.Left &#125; &#125; else &#123; fmt.Println(&quot;both&quot;) curs := cur.Right for &#123; if curs.Left != nil &#123; curs = curs.Left &#125; else &#123; break &#125; &#125; cur.Value = curs.Value mapDel(curs) &#125; &#125; mapDel(cur)&#125; 1234567891011121314151617181920212223func main() &#123; var t Tree t.Insert(100) t.Insert(120) t.Insert(80) t.Insert(70) t.Insert(90) t.Insert(85) t.Insert(95) t.Insert(110) t.Select() t.Delete(80) t.Select() fmt.Println(&quot;---------------&quot;) val := t.Search(110) fmt.Println(val) fmt.Println(t.Min()) fmt.Println(t.Root.Value) fmt.Println(t.Root.Left.Value) fmt.Println(t.Root.Right.Value) t.Edit(80,125) t.Select()&#125;]]></content>
      <categories>
        <category>Go</category>
      </categories>
      <tags>
        <tag>Go</tag>
        <tag>struct</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[常用正则表达式]]></title>
    <url>%2F2019%2F03%2F18%2F2019-03-18-%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[常用正则汇总。 PHP preg_match ( string $pattern , string $subject ) : int 搜索subject与pattern给定的正则表达式的一个匹配. 密码规范包括8 - 16 大小写，符号数字1/^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])[A-Za-z0-9!@#$%*()_+^&amp;]&#123;8,16&#125;$/ 手机号1/^1[3|4|5|7|8][0-9]\d&#123;4,8&#125;$/ 与 pathinfo 功能类似1%^(.*?)[\\\\/]*(([^/\\\\]*?)(\.([^\.\\\\/]+?)|))[\\\\/\.]*$%im 与 parse_url 功能类似12 javaScript12345var reg = /.../reg.test(&apos;18332566840&apos;) //返回 true falsestr.match(reg) //返回 null]]></content>
      <categories>
        <category>regex</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>javaScript</tag>
        <tag>regex</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[正则表达式]]></title>
    <url>%2F2019%2F03%2F18%2F2019-03-18-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[常用正则汇总。 模式匹配修饰符i 忽略模式中的大小写m 多行模式o 仅赋值一次s 单行模式，”.”匹配”\n”（默认不匹配）x 忽略模式中的空白g 全局匹配cg 全局匹配失败后，允许再次查找匹配串 替换操作修饰符i 如果在修饰符中加上”i”，则正则将会取消大小写敏感性，即”a”和”A” 是一样的。m 默认的正则开始”^”和结束”$”只是对于正则字符串如果在修饰符中加上”m”，那么开始和结束将会指字符串的每一行：每一行的开头就是”^”，结尾就是”$”。o 表达式只执行一次。s 如果在修饰符中加入”s”，那么默认的”.”代表除了换行符以外的任何字符将会变成任意字符，也就是包括换行符！x 如果加上该修饰符，表达式中的空白字符将会被忽略，除非它已经被转义。g 替换所有匹配的字符串。e 替换字符串作为表达式 转化操作符c 转化所有未指定字符d 删除所有指定字符s 把多个相同的输出字符缩成一个 更多正则表达式规则. 匹配除换行符以外的所有字符x? 匹配 0 次或一次 x 字符串x 匹配 0 次或多次 x 字符串,但匹配可能的最少次数x+ 匹配 1 次或多次 x 字符串,但匹配可能的最少次数. 匹配 0 次或多次的任何字符.+ 匹配 1 次或多次的任何字符{m} 匹配刚好是 m 个 的指定字符串{m,n} 匹配在 m个 以上 n个 以下 的指定字符串{m,} 匹配 m个 以上 的指定字符串[] 匹配符合 [] 内的字符[^] 匹配不符合 [] 内的字符[0-9] 匹配所有数字字符[a-z] 匹配所有小写字母字符[^0-9] 匹配所有非数字字符[^a-z] 匹配所有非小写字母字符^ 匹配字符开头的字符$ 匹配字符结尾的字符\d 匹配一个数字的字符,和 [0-9] 语法一样\d+ 匹配多个数字字符串,和 [0-9]+ 语法一样\D 非数字,其他同 \d\D+ 非数字,其他同 \d+\w 英文字母或数字的字符串,和 [a-zA-Z0-9_] 语法一样\w+ 和 [a-zA-Z0-9_]+ 语法一样\W 非英文字母或数字的字符串,和 [^a-zA-Z0-9_] 语法一样\W+ 和 [^a-zA-Z0-9_]+ 语法一样\s 空格,和 [\n\t\r\f] 语法一样\s+ 和 [\n\t\r\f]+ 一样\S 非空格,和 [^\n\t\r\f] 语法一样\S+ 和 [^\n\t\r\f]+ 语法一样\b 匹配以英文字母,数字为边界的字符串\B 匹配不以英文字母,数值为边界的字符串a|b|c 匹配符合a字符 或是b字符 或是c字符 的字符串abc 匹配含有 abc 的字符串 (pattern) () 这个符号会记住所找寻到的字符串,是一个很实用的语法.第一个 () 内所找到的字符串变成 $1 这个变量或是 \1 变量,第二个 () 内所找到的字符串变成 $2 这个变量或是 \2 变量,以此类推下去./pattern/i i 这个参数表示忽略英文大小写,也就是在匹配字符串的时候,不考虑英文的大小写问题. \ 如果要在 pattern 模式中找寻一个特殊字符,如 “*”,则要在这个字符前加上 \ 符号,这样才会让特殊字符失效]]></content>
      <categories>
        <category>regex</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>javaScript</tag>
        <tag>regex</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PHP 数据类型]]></title>
    <url>%2F2019%2F03%2F18%2F2019-03-18-PHP%20%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%2F</url>
    <content type="text"><![CDATA[PHP 支持 9 种原始数据类型。四种标量类型：boolean（布尔型）integer（整型）float（浮点型，也称作 double)string（字符串）三种复合类型：array（数组）object（对象）callable（可调用）最后是两种特殊类型：resource（资源）NULL（无类型）伪类型：mixed（混合类型）number（数字类型）callback（回调类型，又称为 callable）array|object（数组 | 对象类型）void （无类型） 简介变量的类型通常不是由程序员设定的，是由 PHP 根据该变量使用的上下文在运行时决定的。 boolean（布尔型）要明确地将一个值转换成 boolean，用 (bool) 或者 (boolean) 来强制转换。但是很多情况下不需要用强制转换，因为当运算符，函数或者流程控制结构需要一个 boolean 参数时，该值会被自动转换。 当转换为 boolean 时，以下值被认为是 FALSE： 1234567布尔值 FALSE 本身整型值 0（零）浮点型值 0.0（零）空字符串，以及字符串 &quot;0&quot;不包括任何元素的数组特殊类型 NULL（包括尚未赋值的变量）从空标记生成的 SimpleXML 对象 (没有验证过 ...) 例子12345var_dump(0 == &apos;all&apos;); // truevar_dump((int)&apos;all&apos;); // int(0)var_dump(0 == (bool)&apos;all&apos;); // falsevar_dump((int)true); // int(1) integer（整型）整型值可以使用十进制，十六进制，八进制或二进制表示，前面可以加上可选的符号（- 或者 +）。要使用八进制表达，数字前必须加上 0（零）。要使用十六进制表达，数字前必须加上 0x。要使用二进制表达，数字前必须加上 0b。用 (int) 或 (integer) 强制转换。 123var_dump(PHP_INT_SIZE); // 结果：int(4) // 占用4个字节var_dump(PHP_INT_NAX); // 结果：int(2147483647) // php中int不支持无符号var_dump(PHP_INT_MIN); // 结果：int(-2147483648) 例子123echo (int) ( 1.6); // 显示 1 // 当从浮点数转换成整数时，将向下取整。echo (int)@NaN . PHP_EOL; // int(0) // PHP 7.0.0 起，NaN 和 Infinity 在转换成 integer 时，不再是 undefined 或者依赖于平台，而是都会变成零。echo (int) ( (0.1+0.7) * 10 ); // 显示 7 // 浮点数强制转换 integer，会出现不可预料的错误 待验证：在32位平台上int占4个字节，在64位平台上int占8个字节,16位平台是则分配2个字节整型数的字长和平台有关，尽管通常最大值是大约二十亿（32 位有符号）。64 位平台下的最大值通常是大约 9E18，除了 Windows 下 PHP 7 以前的版本，总是 32 位的。 PHP 不支持无符号的 integer。Integer 值的字长可以用常量 PHP_INT_SIZE来表示，自 PHP 4.4.0 和 PHP 5.0.5后，最大值可以用常量 PHP_INT_MAX 来表示，最小值可以在 PHP 7.0.0 及以后的版本中用常量 PHP_INT_MIN 表示。 float（浮点型，也称作 double)]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PHP-javaScript-RSA 非对称加密]]></title>
    <url>%2F2019%2F03%2F15%2F2019-04-09-PHP-javaScript-RSA%20%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%2F</url>
    <content type="text"><![CDATA[基于 jsencrypt.js 之 javaScript 加密，PHP解密。 (应用于登录注册)。前端后台数据交互需要进行加密之后传输使用，以保证系统数据的安全。非对称加密速度慢，所以只能加密较小的数据。可以在AES 基础上进行RSA 加密(将数据 AES 加密，在用RSA 加密 AES的密钥)。 JavaScript1234567891011121314151617181920212223242526272829&lt;script src=&apos;&#123;&#123;asset(&quot;js/jsencrypt.min.js&quot;)&#125;&#125;&apos;&gt;&lt;/script&gt;&lt;script&gt; var username = &apos;1112223&apos;, password = &apos;123456&apos;; function rsa(text, key) &#123; var encrypt = new JSEncrypt(); encrypt.setPublicKey(key); var encrypted = encrypt.encrypt(text); return encrypted; &#125; $.ajax(&#123; url:&apos;http://www.you.com/test/rsa/public&apos;, // 发送请求获取 公钥 type:&apos;post&apos;, dataType:&apos;json&apos;, success:function(data) &#123; // data 返回的 public key var en = rsa(password, data.result); $.ajax(&#123; url:&apos;http://www.you.com/test/rsa/doLogin&apos;, type:&apos;post&apos;, dataType:&apos;json&apos;, data:&#123;password:en&#125;, success:function(data) &#123; console.log(data); &#125; &#125;); &#125; &#125;);&lt;/script&gt; PHP 确认是否有openssl 扩展 12345 $privKey = openssl_pkey_get_private($private_key);$encrypted = base64_decode($encrypted); // jsencrypt, 默认使用base64 加密，所以需要解密// Decrypt the data using the private key and store the results in $decryptedopenssl_private_decrypt($encrypted, $decrypted, $privKey); // $encrypted 需要解密的文本return $decrypted; 生成私钥、公钥12345678910111213$config = array( &quot;digest_alg&quot; =&gt; &quot;sha512&quot;, &quot;private_key_bits&quot; =&gt; 4096, &quot;private_key_type&quot; =&gt; OPENSSL_KEYTYPE_RSA, );$res = openssl_pkey_new($config);openssl_pkey_export($res, $privKey);$pubKey = openssl_pkey_get_details($res);$pubKey = $pubKey[&quot;key&quot;];// 将私钥 $privKey , 和公钥 $pubKey 保存起来file_put_contents(&apos;./cert_public.key&apos;, $pubKey);file_put_contents(&apos;./cert_private.pem&apos;, $privKey);]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>javaScript</tag>
        <tag>RSA</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PHP-javaScript-AES 对称加密]]></title>
    <url>%2F2019%2F03%2F15%2F2019-03-15-php-javascript-AES%20%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%2F</url>
    <content type="text"><![CDATA[基于 Crypto.js 之 javaScript 加密，PHP解密。 (应用于登录注册)。前端后台数据交互需要进行加密之后传输使用，以保证系统数据的安全。 javaScript1234567891011121314151617&lt;script src=&quot;../node_modules/_crypto-js@3.1.9-1@crypto-js/crypto-js.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot;&gt; var password = &apos;123456&apos;; var aes_password = encrypt(password); // aes_password 加密后的数据 function encrypt(text)&#123; var key = CryptoJS.enc.Latin1.parse(&apos;AQSWDEFRGT@#$%^&amp;&apos;); //为了避免补位，直接用16位的秘钥 var iv = CryptoJS.enc.Latin1.parse(&apos;AQSWDE@#$%^&amp;FRGT&apos;); //16位初始向量 var encrypted = CryptoJS.AES.encrypt(text, key, &#123; iv: iv, mode:CryptoJS.mode.CBC, padding:CryptoJS.pad.ZeroPadding &#125;); return encrypted.toString(); &#125;&lt;/script&gt; PHP123$key = &quot;AQSWDEFRGT@#$%^&amp;&quot;;$iv = &quot;AQSWDE@#$%^&amp;FRGT&quot;;$password = openssl_decrypt($password, &apos;aes-128-cbc&apos;, $key, OPENSSL_ZERO_PADDING , $iv); 如果想做安全一点就是前端和后台是用同一个算法来生成key,使其不是唯一。然后不停的交换秘钥，这种情况下用户只有分析js秘钥生成算法和密文信息才有可能解密出来。 Crypto.js]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>javaScript</tag>
        <tag>AES</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[搭建-LNMP-环境]]></title>
    <url>%2F2018%2F06%2F20%2F2018-06-20-%E6%90%AD%E5%BB%BA-LNMP-%E7%8E%AF%E5%A2%83%2F</url>
    <content type="text"><![CDATA[LNMP : linux + nginx1 + mysql5 + php7 依赖文件 我们后边要安装的php、apache、mysql等相关的软件，这些软件都是通过C语言或C++语言编写的，因此需要安装gcc和gcc-c++编译器。 zlib软件是后续其他软件的依赖软件，有其他软件有代码优化压缩的作用。 安装 Nginx下载 nginx 官网：http://nginx.org 下载：http://nginx.org/download/nginx-1.12.2.tar.gz 依赖文件(解压, 安装)1[root@localhost ~] yum -y install pcre-devel pcre 是线上产品 pcre-devel(develop)是开发调试版本产品，里边有一些功能是线上产品不不具备 pcre： 包括 perl 兼容的正则表达式库 nginx install123[root@localhost ~] tar zxf nginx-1.12.2.tar.gz[root@localhost ~] ./configure --prefix=/usr/local/nginx --with-http_ssl_module[root@localhost ~] make &amp;&amp; make install –with-http_ssl_module //配置https安全型协议支持 nginx 目录 conf：配置文件目录 html：网站默认请求目录，与apache的htdocs目录作用一致 logs：记录日志文件目录 sbin：执行程序文件目录，里边有一个nginx执行程序文件，负责控制nginx服务 控制服务在/usr/local/nginx/sbin目录里边进行服务操控 123[root@localhost ~] ./nginx 开启apache服务[root@localhost ~] ./nginx -s stop 关闭apache服务[root@localhost ~] ./nginx -s reload 重启apache服务 防火墙为了使得外部用户浏览器可以访问到nginx服务效果，还需要把linux系统本身的防火墙给予关闭掉 1[root@localhost ~] setup 安装 PHP apache+PHP：php是apache内部的功能模块，它们是包含与被包含的关系 nginx+PHP：php作为独立服务运行，与nginx地位平等 安装 依赖php install123[root@localhost ~] tar zxf php-7.0.25.tar.gz[root@localhost ~] ./configure --prefix=/usr/local/php7.0 --with-config-file-path=/usr/local/php7.0/etc --with-curl --with-freetype-dir --with-gd --with-gettext --with-iconv-dir --with-kerberos --with-jpeg-dir --with-libxml-dir --with-mysqli --with-openssl --with-pcre-regex --with-pdo-mysql --with-pear --with-png-dir --with-xmlrpc --with-xsl --with-zlib --enable-bcmath --enable-libxml --enable-inline-optimization --enable-gd-native-ttf --enable-mbregex --enable-mbstring --enable-opcache --enable-pcntl --enable-shmop --enable-soap --enable-sockets --enable-sysvsem --enable-xml --enable-zip --enable-fpm[root@localhost ~] make &amp;&amp; make install 现在我们给php做configure配置，和 LAMP 不同的是： 去除apache参数 增加enable-fpm，作用是使得php作为独立服务运行 增加–with-config-file-path参数，设置php.ini配置文件存储目录 php 目录 bin： 运行目录，里边有php脚本文件，可以运行php程序文件。还有用于添加扩展的phpize和php-config等文件 etc： 配置文件目录，马上要把php.ini创建在该目录 include： 包含目录，其中include/php/ext是php扩展功能目录，例如gd、mysqli、libxml、pcre、pdo等都安装在该目录 lib： library资源库目录，其中lib/php/extensions/no-debug-non-zts-20151012目录是用于存储后期给php增加相关功能模块，例如redis.so、memcache.so等都会存储在该目录，并且在php.ini文件中可以直接引入 sbin： 运行目录，里边的php-fpm是负责管理php服务的 var： variable变化目录，该目录中有run和log目录，都是存储php运行过程中产生的日志或临时文件的 参数 详解 –with-apxs2=/usr/local/apache2/bin/apxs –&gt; 上边的指令会在安装php的时候就自动生成php模块，名称为libphp7so，并且该模块会生成到apache的对应模块目录(/usr/local/apache2/modules/)里边，然后还会自动去修改httpd.conf文件，使得引入该libphp7.so的模块 –with-curl –&gt; 打开curl的支持，使得php可以访问其他网站的网址并获得对应的内容，是爬虫技术范畴，file_get_contents(“http://xxx”); –with-freetype-dir –&gt; 字体库支持 –with-gd –&gt; 画图技术支持，我们并不需要主动安装gd库，该gd库已经被集成在php内部(如下图)了，随着php安装gd库也会被自动安装好 –with-gettext –&gt; 支持开发多语言系统 –with-iconv-dir –&gt; iconv函数库能够完成各种字符集间的转换 –with-kerberos –&gt; kerberos支持 –with-jpeg-dir –&gt; jpeg图片格式支持 –with-libxml-dir –&gt; libxml2库的支持 –with-mysqli –&gt; Mysqli数据库的支持 –with-openssl –&gt; openssl的支持，加密传输时用到的,类似这样的协议https://xx就需要openssl的技术支持 –with-pcre-regex –&gt; 正则表达式支持 –with-pdo-mysql –&gt; pdo-mysql支持 –with-pear –&gt; pear是PHP的扩展和应用程序库，包含了很多有用的类 –with-png-dir –&gt; png图片格式支持 –with-xmlrpc –&gt; xml相关的扩展库支持 –with-xsl –&gt; 打开XSLT 文件支持，扩展了libXML2库 ，需要libxslt软件 –with-zlib –&gt; zlib压缩库支持 –enable-bcmath –&gt; 图片大小调整技术支持 –enable-libxml –&gt; xml支持 –enable-inline-optimization –&gt; 优化线程，给php整体做性能优化处理 –enable-gd-native-ttf –&gt; 画图字体库支持，支持TrueType字符串函数库 –enable-mbregex –&gt; 正则表达式支持 –enable-mbstring –&gt; mb宽字节函数库支持 –enable-opcache –&gt; 缓存支持 –enable-pcntl –&gt; pcntl扩展可以支持php的多线程操作 –enable-shmop –&gt; shmop是一个易于使用的功能集，允许PHP读，写，创建和删除UNIX共享内存段 –enable-sysvsem –&gt; 作用同上 –enable-soap –&gt; SOAP 的全称为简单对象访问协议 (Simple Object Access Protocol)。它是一种基于 XML 的，可扩展的通信协议。SOAP 提供了一种标准，使得运行在不同平台上并使用不同的编程语言编写的应用程序可以互相进行通信 –enable-sockets –&gt; sockets 支持 –enable-xml –&gt; xml支持 –enable-zip –&gt; php支持对zip压缩包处理 (上述有一些配置参数没有设置依赖软件的路径名，其会到系统默认位置找到对应的软件，如果依赖软件没有安装到系统默认位置，则需要通过完整路径名显示设置好。还有一些配置参数本身就是“是或否”的意思，则不需要设置依赖路径名) 制作php.ini文件在php解压目录里边把php.ini-development 复制到/usr/local/php7.0/lib/php.ini 1[root@localhost ~] cp php.ini-development /usr/local/php7.0/lib/php.ini 服务配置文件php是作为独立服务与nginx进行合作工作的，现在需要给“php服务”创建配置文件 创建主配置文件 把php-fpm.conf.default文件复制到当前目录并改名字为php-fpm.conf，这个文件就是“php服务”的主配置文件 123[root@localhost ~] pwd/usr/local/php7.0/etc[root@localhost ~] cp php-fpm.conf.default php-fpm.conf 辅助配置文件 /usr/local/php7.0/etc/php-fpm.d/www.conf.default 辅助配置文件在“辅助配置文件”中有“php服务”运行的详细参数(例如服务的端口号码9000等)，只有被主配置文件引入后php服务才可以正常运行代表对辅助配置文件进行引入，但是辅助配置文件需要改名字为.conf后缀的 123[root@localhost ~] pwd/usr/local/php7.0/etc/php-fpm.d[root@localhost ~] cp www.conf.default www.conf 服务控制 php-fpm 启动 killall php-fpm 关闭 nginx与php结合安装 MySQL卸载旧的 MySQL, 同apache下载mysql组件 官网：https://www.mysql.com 下载地址：https://dev.mysql.com/downloads/mysql/ MySQL install1234[root ~] rpm -ivh mysql-community-common-5.7.20-1.el6.i686.rpm[root ~] rpm -ivh mysql-community-libs-5.7.20-1.el6.i686.rpm[root ~] rpm -ivh mysql-community-client-5.7.20-1.el6.i686.rpm[root ~] rpm -ivh mysql-community-server-5.7.20-1.el6.i686.rpm 以上组件的安装是有自上而下的顺序要求，因为它们彼此有依赖关系。 服务控制1[root@localhost ~] service mysqld start[/stop/restart] 查看默认的root帐号密码1[root@localhost ~] grep &quot;root@localhost&quot; /var/log/mysqld.log 修改root帐号密码1mysql&gt; ALTER USER &apos;root&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;123456&apos;; 设置字符集在配置文件最后添加以下内容： 连接mysql时的字符集设置为utf8mb4init-connect=’SET NAMES utf8mb4’ 默认存储引擎为INNODBdefault-storage-engine=INNODB 服务器端字符集设置为utf8mb4character-set-server=utf8mb4[mysql] mysql本身字符集设置为utf8mb4default-character-set = utf8mb4[client] 客户端操作mysql时字符集设置为utf8mb4default-character-set = utf8mb4 工步他始能詩的，裝進分星海演意學值例道……於財型目古香亮自和這乎？化經溫詩。只賽嚴大一主價世哥受的沒有中年即病行金拉麼河。主小路了種就小為廣不？]]></content>
      <categories>
        <category>env</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>linux</tag>
        <tag>mysql</tag>
        <tag>nginx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[搭建-LAMP-环境]]></title>
    <url>%2F2018%2F05%2F10%2F2018-05-10-%E6%90%AD%E5%BB%BA-LAMP-%E7%8E%AF%E5%A2%83%2F</url>
    <content type="text"><![CDATA[LAMP : linux + apache2 + mysql5 + php7 删除旧的 apache 把操作系统默认安装的apache给卸载掉，避免与我们要安装的有冲突 1[root@localhost ~] yum list installed | grep httpd 卸载与httpd有关系的软件 12[root@localhost ~] yum -y remove httpd[root@localhost ~] yum -y remove httpd-tools 再整个系统中找与httpd有关系的文件或目录 1[root@localhost ~] find / -name httpd 删除与httpd有关系的文件 12[root@localhost ~] rm -rf /etc/httpd[root@localhost ~] rm -rf /usr/lib/httpd 依赖文件 我们后边要安装的php、apache、mysql等相关的软件，这些软件都是通过C语言或C++语言编写的，因此需要安装gcc和gcc-c++编译器。 zlib软件是后续其他软件的依赖软件，有其他软件有代码优化压缩的作用。 安装 Apache依赖文件(解压, 安装)123456[root@localhost ~] tar zxf apr-1.5.2.tar.gz [root@localhost ~] ./configure --prefix=/usr/local/apr[root@localhost ~] tar zxf apr-util-1.5.4.tar.gz[root@localhost ~] ./configure --prefix=/usr/local/apr-util --with-apr=/usr/local/apr[root@localhost ~] tar zxf pcre-8.40.tar.gz[root@localhost ~] ./configure --prefix=/usr/local/pcre apache install123[root@localhost ~] tar zxf httpd-2.4.29.tar.gz[root@localhost ~] ./configure --prefix=/usr/local/apache2 --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --with-pcre=/usr/local/pcre --with-z=/usr/local/zlib --enable-so --enable-rewrite[root@localhost ~] make &amp;&amp; make install –enable-so 让apache激活并可以识别使用so后缀的功能模块 –enable-rewrite 开启重写模块(可以修改地址栏信息，例如隐藏index.php入口文件) 控制服务在/usr/local/apache2/bin目录里边进行服务操控 123[root@localhost ~] ./apachectl start 开启apache服务[root@localhost ~] ./apachectl stop 关闭apache服务[root@localhost ~] ./apachectl restart 重启apache服务 防火墙为了使得外部用户浏览器可以访问到apache服务效果，还需要把linux系统本身的防火墙给予关闭掉 1[root@localhost ~] setup 安装 PHP安装 依赖12345678910111213[root@localhost ~] yum -y install libxml2-develxml库依赖支持[root@localhost ~] yum -y install openssl-developenssl： 支持安全传输协议https[root@localhost ~] yum -y install libcurl-develcurl是服务器彼此间调用的接口，常用于爬虫技术[root@localhost ~] yum -y install libjpeg-turbo-devel[root@localhost ~] yum -y install libpng-develpng图片格式支持[root@localhost ~] yum -y install freetype-devel画图字体库支持[root@localhost ~] yum -y install libxslt-devel打开XSLT 文件支持，扩展了libXML2库 php install12[root@localhost ~] tar zxf php-7.0.25.tar.gz[root@localhost ~] ./configure --prefix=/usr/local/php7.0 --with-apxs2=/usr/local/apache2/bin/apxs --with-curl --with-freetype-dir --with-gd --with-gettext --with-iconv-dir --with-kerberos --with-jpeg-dir --with-libxml-dir --with-mysqli --with-openssl --with-pcre-regex --with-pdo-mysql --with-pear --with-png-dir --with-xmlrpc --with-xsl --with-zlib --enable-bcmath --enable-libxml --enable-inline-optimization --enable-gd-native-ttf --enable-mbregex --enable-mbstring --enable-opcache --enable-pcntl --enable-shmop --enable-soap --enable-sockets --enable-sysvsem --enable-xml --enable-zip 参数 详解 –with-apxs2=/usr/local/apache2/bin/apxs –&gt; 上边的指令会在安装php的时候就自动生成php模块，名称为libphp7so，并且该模块会生成到apache的对应模块目录(/usr/local/apache2/modules/)里边，然后还会自动去修改httpd.conf文件，使得引入该libphp7.so的模块 –with-curl –&gt; 打开curl的支持，使得php可以访问其他网站的网址并获得对应的内容，是爬虫技术范畴，file_get_contents(“http://xxx”); –with-freetype-dir –&gt; 字体库支持 –with-gd –&gt; 画图技术支持，我们并不需要主动安装gd库，该gd库已经被集成在php内部(如下图)了，随着php安装gd库也会被自动安装好 –with-gettext –&gt; 支持开发多语言系统 –with-iconv-dir –&gt; iconv函数库能够完成各种字符集间的转换 –with-kerberos –&gt; kerberos支持 –with-jpeg-dir –&gt; jpeg图片格式支持 –with-libxml-dir –&gt; libxml2库的支持 –with-mysqli –&gt; Mysqli数据库的支持 –with-openssl –&gt; openssl的支持，加密传输时用到的,类似这样的协议https://xx就需要openssl的技术支持 –with-pcre-regex –&gt; 正则表达式支持 –with-pdo-mysql –&gt; pdo-mysql支持 –with-pear –&gt; pear是PHP的扩展和应用程序库，包含了很多有用的类 –with-png-dir –&gt; png图片格式支持 –with-xmlrpc –&gt; xml相关的扩展库支持 –with-xsl –&gt; 打开XSLT 文件支持，扩展了libXML2库 ，需要libxslt软件 –with-zlib –&gt; zlib压缩库支持 –enable-bcmath –&gt; 图片大小调整技术支持 –enable-libxml –&gt; xml支持 –enable-inline-optimization –&gt; 优化线程，给php整体做性能优化处理 –enable-gd-native-ttf –&gt; 画图字体库支持，支持TrueType字符串函数库 –enable-mbregex –&gt; 正则表达式支持 –enable-mbstring –&gt; mb宽字节函数库支持 –enable-opcache –&gt; 缓存支持 –enable-pcntl –&gt; pcntl扩展可以支持php的多线程操作 –enable-shmop –&gt; shmop是一个易于使用的功能集，允许PHP读，写，创建和删除UNIX共享内存段 –enable-sysvsem –&gt; 作用同上 –enable-soap –&gt; SOAP 的全称为简单对象访问协议 (Simple Object Access Protocol)。它是一种基于 XML 的，可扩展的通信协议。SOAP 提供了一种标准，使得运行在不同平台上并使用不同的编程语言编写的应用程序可以互相进行通信 –enable-sockets –&gt; sockets 支持 –enable-xml –&gt; xml支持 –enable-zip –&gt; php支持对zip压缩包处理 (上述有一些配置参数没有设置依赖软件的路径名，其会到系统默认位置找到对应的软件，如果依赖软件没有安装到系统默认位置，则需要通过完整路径名显示设置好。还有一些配置参数本身就是“是或否”的意思，则不需要设置依赖路径名) 制作php.ini文件在php解压目录里边把php.ini-development 复制到/usr/local/php7.0/lib/php.ini 1[root@localhost ~] cp php.ini-development /usr/local/php7.0/lib/php.ini 安装 MySQL卸载旧的 MySQL, 同apache下载mysql组件 官网：https://www.mysql.com 下载地址：https://dev.mysql.com/downloads/mysql/ MySQL install1234[root ~] rpm -ivh mysql-community-common-5.7.20-1.el6.i686.rpm[root ~] rpm -ivh mysql-community-libs-5.7.20-1.el6.i686.rpm[root ~] rpm -ivh mysql-community-client-5.7.20-1.el6.i686.rpm[root ~] rpm -ivh mysql-community-server-5.7.20-1.el6.i686.rpm 以上组件的安装是有自上而下的顺序要求，因为它们彼此有依赖关系。 服务控制1[root@localhost ~] service mysqld start[/stop/restart] 查看默认的root帐号密码1[root@localhost ~] grep &quot;root@localhost&quot; /var/log/mysqld.log 修改root帐号密码1mysql&gt; ALTER USER &apos;root&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;123456&apos;; 设置字符集在配置文件最后添加以下内容： 连接mysql时的字符集设置为utf8mb4init-connect=’SET NAMES utf8mb4’ 默认存储引擎为INNODBdefault-storage-engine=INNODB 服务器端字符集设置为utf8mb4character-set-server=utf8mb4[mysql] mysql本身字符集设置为utf8mb4default-character-set = utf8mb4[client] 客户端操作mysql时字符集设置为utf8mb4default-character-set = utf8mb4 工步他始能詩的，裝進分星海演意學值例道……於財型目古香亮自和這乎？化經溫詩。只賽嚴大一主價世哥受的沒有中年即病行金拉麼河。主小路了種就小為廣不？]]></content>
      <categories>
        <category>env</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>linux</tag>
        <tag>apache</tag>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2017%2F03%2F16%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
</search>
